<!DOCTYPE html>
<html>
<head>
  <title>Noise Detector</title>
  <style>
    body {
      background-image: url("/static/background.jpg");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;     /* ç¦æ­¢é‡è¤‡æ‹¼æ¥ */
      background-attachment: fixed;
      font-family: Arial, sans-serif;
      color: white;
    }

    .panel {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 20px;
      border-radius: 10px;
      max-width: 600px;
      margin: auto;
    }

    h1, h2 {
      text-align: center;
    }

    .waveform-container {
      background-color: #1e1e1e; /* æ·±è‰²èƒŒæ™¯ */
      border: 1px solid #444;   /* æ·±ç°é‚Šæ¡† */
      border-radius: 10px;
      padding: 10px;
      margin-top: 10px;
      overflow-x: auto;
      white-space: nowrap;
    }
    
    .waveform-container::-webkit-scrollbar {
      height: 8px;
    }

    .waveform-container::-webkit-scrollbar-track {
      background: #2a2a2a;
      border-radius: 10px;
    }

    .waveform-container::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 10px;
    }

    .waveform-container::-webkit-scrollbar-thumb:hover {
      background: #bbb;
    }


    .waveform-container img {
      display: inline-block;
      max-height: 200px; /* èª¿æ•´åœ–åƒé«˜åº¦ */
    }

    #status {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="panel">
    <h1>Noise Detector</h1>
    <form method="post">
      <label>Recording Duration (seconds):</label>
      <input type="number" name="duration" value="5" min="3" required>
      <button type="submit" onclick="showRecording()">é–‹å§‹éŒ„éŸ³</button>
    </form>
    <p id="status"></p>

    {% if result %}
      <h2>åˆ†æçµæœ</h2>
      <ul>
        <li title="RMS (Root Mean Square)ï¼šä»£è¡¨æ•´æ®µéŸ³è¨Šçš„å¹³å‡èƒ½é‡å¤§å°ï¼Œæ•¸å€¼è¶Šå¤§è¡¨ç¤ºéŸ³é‡è¶Šé«˜">
          RMS: {{ result.rms | round(4) }}
        </li>
        <li title="Peakï¼šéŒ„éŸ³ä¸­æœ€å¤§éŸ³é‡ï¼Œä»£è¡¨ç¬é–“æœ€éŸ¿äº®çš„è²éŸ³å¼·åº¦">
          Peak: {{ result.peak | round(4) }}
        </li>
        <li title="Silence Ratioï¼šéŸ³è¨Šä¸­è¢«è¦–ç‚ºéœéŸ³çš„æ¯”ä¾‹ï¼Œ1.0 è¡¨ç¤ºæ•´æ®µå¹¾ä¹æ²’è²éŸ³">
          Silence Ratio: {{ result.silence_ratio | round(4) }}
        </li>
      </ul>

      <h2>ğŸ”Š éŒ„éŸ³é‡æ’­</h2>
      <audio controls>
        <source src="{{ url_for('static', filename='web_recording.wav') }}" type="audio/wav">
        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³è¨Šæ’­æ”¾ã€‚
      </audio>
    {% endif %}

    {% if waveform %}
      <h2>Waveform</h2>
      <div class="waveform-container">
        <img src="data:image/png;base64,{{ waveform }}" alt="Waveform">
      </div>
    {% endif %}
  </div>

  <script>
    function showRecording() {
      const status = document.getElementById("status");
      status.innerText = "ğŸ™ï¸ éŒ„éŸ³ä¸­...";
      status.style.color = "lime";
    }
  </script>
</body>
</html>
